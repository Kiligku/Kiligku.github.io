---
title: 利用git实现hexo多设备笔记同步
date: 2023-09-09 21:58:46

tags:
---
# 利用git实现hexo多设备笔记同步

问题：github仓库上只储存了hexo网页的源代码而没有储存笔记的源文件，导致其他设备无法向网页中直接添加新的笔记。一种显然的方法是把其他设备写完的笔记发到老设备上然后在老设备上```hexo -g```，但这肯定不是一种优雅的办法，于是便开始研究基于git的同步方法。

## 1. 前置工作
在github的hexo仓库创建新的分支（后面称为hexo分支），存储生成网页代码的素材文件夹（后面简称为blog文件夹），然后在新设备上创建新文件夹，克隆之前创建的hexo分支。
```
git clone -b hexo <repo link> 
```

## 2. 添加/修改笔记的设备需要的操作（将该设备称为设备A）
1. 设备A在本地增加/修改笔记a
2. 将本地仓库切换到hexo分支（主分支存放网页代码）
3. 设备A将新笔记添加到暂存区
   
4. 通过```git commit -m <message>```将笔记添加到本地仓库 
5. 通过```git push <远程主机名> <本地分支名>:<远程分支名>```将本地仓库的变化同步到远程仓库中(查看远程主机名可以用```git remote```指令)

## 3. 另一台设备同步需要的操作（将该设备称为设备B）
 1. 用```git pull <远程主机名> <远程分支名>:<本地分支名>```同步远程仓库到本地工作区的hexo分支
 2. 在本地工作区继续编辑，此时B主机为添加/修改笔记的设备，重复上述步骤。

## 注意事项
在一端对文件a已有已上传的更改时，另一端没有及时把远程仓库同步到本地，然后对本地仓库进行更改，此时再进行```git push```或```git pull```就会报non-fast-forward错误。正确的做法是在进行更改之前先同步远程仓库。（冲突的解决方法打算另开一篇细讲）